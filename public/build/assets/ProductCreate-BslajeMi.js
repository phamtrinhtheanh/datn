import{d as K,G as Q,c as U,r as W,x as Z,a as d,o as a,b as n,u as e,g as J,w as l,e as i,W as y,f as u,l as I,i as f,t as m,F as h,j as x,h as P,H as X,I as Y,p as w,J as ee,K as te,L as se}from"./app-CmJJduxX.js";import{_ as V}from"./index-D8-AFNwL.js";import{_ as T}from"./Checkbox.vue_vue_type_script_setup_true_lang-BcJm8B5R.js";import{_ as v}from"./Input.vue_vue_type_script_setup_true_lang-BnKsr0LL.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-BEUZd-tX.js";import{_ as N,a as B,b as R,c as j,d as G}from"./SelectValue.vue_vue_type_script_setup_true_lang-8wnpaB1E.js";import{_ as oe}from"./AppLayout.vue_vue_type_script_setup_true_lang-B1baMaTs.js";import{u as re,Q as ie}from"./vue-quill.snow-BHzep98B.js";import"./useForwardPropsEmits-D044zIqy.js";import"./useForwardExpose-BM1jTi0X.js";import"./check-Bn4QJ5u6.js";import"./createLucideIcon-CdlTwhfE.js";import"./useFormControl-CDuwxkrt.js";import"./Collection-Cexjku1s.js";import"./usePrimitiveElement-hbI6zDTX.js";import"./RovingFocusGroup-32-9kDbx.js";import"./VisuallyHiddenInput-DJh-D3Mb.js";import"./VisuallyHidden-CtYPX-TC.js";import"./DialogPortal-Bybb0N8i.js";import"./useFocusGuards-DI5oPacC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BsuO-TMD.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DeJamkU1.js";import"./x-CMWJtdGN.js";import"./shopping-cart-D22-DgzM.js";import"./Sonner.vue_vue_type_script_setup_true_lang-l-Dfm-6H.js";import"./vue-sonner-DAmkgFkX.js";const ne={class:"container mx-auto py-6"},le={class:"mb-6 flex items-start justify-between"},ae={class:"bg-card container rounded-lg border p-6 shadow-sm",id:"form-tb"},de={class:"grid grid-cols-2 gap-6"},pe={class:"gap-4 space-y-4"},ue={class:"col-span-4 space-y-2"},ce={key:0,class:"text-sm text-red-500"},me={class:"grid grid-cols-2 gap-4"},_e={key:0,class:"text-sm text-red-500"},fe={key:0,class:"text-sm text-red-500"},ge={class:"space-y-2"},he={class:"space-y-2"},ve={key:0,class:"text-sm text-red-500"},ye={class:"col-span-2 flex items-end space-x-2"},xe={class:"col-span-2 flex items-end space-x-2"},be={class:"grid grid-cols-4 gap-4"},ke={class:"space-y-2"},we={key:0,class:"text-sm text-red-500"},Ve={class:"space-y-2"},Ce={key:0,class:"text-sm text-red-500"},Me={class:"space-y-2"},Se={key:0,class:"text-sm text-red-500"},De={class:"space-y-2"},$e={key:0,class:"text-sm text-red-500"},Ae={class:"space-y-2"},Ue={class:"space-y-4"},Ie={class:"grid grid-cols-4 gap-4"},Pe={class:"group relative col-span-3 aspect-square"},Te={key:0,class:"relative h-full w-full"},Ne=["src"],Be={key:0,class:"text-sm text-gray-500"},Re={key:1,class:"text-sm text-gray-500"},je={class:"space-y-4"},Ge=["onClick"],Le=["src"],Fe=["onClick"],He={key:0,class:"text-sm text-red-500"},qe={class:"col-span-full w-full space-y-2"},ze={key:0,class:"text-sm text-red-500"},Ee={class:"flex justify-end gap-4"},xt=K({__name:"ProductCreate",setup(Oe){const C=Q(),L=U(()=>{var r;return((r=C.props.brands)==null?void 0:r.data)||[]}),F=U(()=>{var r;return((r=C.props.categories)==null?void 0:r.data)||[]}),c=W([]),s=Z({name:"Mainboard MSI PRO Z790-A DDR4",description:"<p><strong>MSI PRO Z790-A DDR4</strong> là bo mạch chủ lý tưởng cho các hệ thống Intel thế hệ 12/13, hỗ trợ RAM DDR4, nhiều khe M.2 tốc độ cao và mạng LAN 2.5G.</p><ul>  <li>Thiết kế tản nhiệt tối ưu, bền bỉ</li>  <li>Hỗ trợ ép xung CPU và RAM</li>  <li>Đầy đủ cổng kết nối hiện đại</li>  <li>Phù hợp cho cả game thủ và dân văn phòng</li></ul><p><em>Bảo hành chính hãng 36 tháng.</em></p>",price:52e5,line_price:55e5,import_price:4e6,stock:10,images:[],is_featured:!1,is_active:!0,brand_id:"",category_id:"",specs:`{
  "Socket": "LGA 1700",
  "Chipset": "Intel Z790",
  "Kích thước": "ATX",
  "RAM hỗ trợ": "4 x DDR4, tối đa 128GB",
  "Khe mở rộng": "3 x PCIe x16, 1 x PCIe x1",
  "Lưu trữ": "4 x SATA 6Gb/s, 4 x M.2",
  "LAN": "Intel 2.5G LAN",
  "USB": "2 x USB 3.2 Gen2 Type-A, 1 x USB 3.2 Gen2x2 Type-C, 4 x USB 2.0",
  "Audio": "Realtek ALC897 7.1-Channel High Definition Audio"
}`,_method:"POST"});async function H(r){const t=new FormData;t.append("file",r);try{return(await se.post(route("admin.upload"),t,{headers:{"Content-Type":"multipart/form-data"}})).data.url}catch(p){throw console.error("Upload failed:",p),p}}async function M(r,t){if(s.images.length+r.length>4){alert("Chỉ được upload tối đa 4 ảnh");return}const p=r.filter(o=>o.size>5*1024*1024?(alert(`File ${o.name} vượt quá kích thước cho phép (5MB)`),!1):o.type.startsWith("image/")?!0:(alert(`File ${o.name} không phải là file ảnh`),!1));for(const o of p)try{const g=await H(o);s.images.push(g);const b={id:Math.random().toString(36).substr(2,9),url:g,isMain:c.value.length===0};c.value.push(b)}catch{alert(`Không thể upload file ${o.name}`)}t.length>0&&console.log("Rejected files:",t)}const{getRootProps:S,getInputProps:D,isDragActive:q}=re({onDrop:M,accept:["image/*"],maxFiles:4,maxSize:5*1024*1024,noClick:!0}),$=()=>{const r=document.createElement("input");r.type="file",r.accept="image/*",r.multiple=!0,r.onchange=async t=>{const p=t.target.files;p&&await M(Array.from(p),[])},r.click()},A=r=>{s.images.splice(r,1),c.value.splice(r,1),c.value.length>0&&!c.value.some(t=>t.isMain)&&(c.value[0].isMain=!0)},z=r=>{c.value.forEach((t,p)=>{t.isMain=p===r})},E=()=>{const r=new FormData;r.append("name",s.name),r.append("description",s.description),r.append("price",s.price.toString()),r.append("line_price",s.line_price.toString()),r.append("import_price",s.import_price.toString()),r.append("stock",s.stock.toString()),r.append("is_featured",s.is_featured?"1":"0"),r.append("is_active",s.is_active?"1":"0"),r.append("brand_id",s.brand_id),r.append("category_id",s.category_id),r.append("specs",s.specs),r.append("_method","POST"),s.images.forEach((t,p)=>{r.append(`images[${p}]`,t),c.value[p].isMain&&r.append("main_image_index",p.toString())}),y.post(route("admin.products.store"),r,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{y.visit(route("admin.products.index"))},onError:t=>{console.error("Upload failed:",t)}})},O={theme:"snow",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]}};return(r,t)=>(a(),d(h,null,[n(e(J),{title:"Create Product"}),n(oe,null,{default:l(()=>{var p;return[i("div",ne,[i("div",le,[t[15]||(t[15]=i("h1",{class:"mb-4 text-3xl font-extrabold"},"Thêm sản phẩm mới",-1)),n(e(V),{variant:"outline",onClick:t[0]||(t[0]=o=>e(y).visit(r.route("admin.products.index")))},{default:l(()=>t[14]||(t[14]=[u("Quay lại")])),_:1,__:[14]})]),i("div",ae,[i("form",{onSubmit:I(E,["prevent"]),class:"space-y-6"},[i("div",de,[i("div",pe,[i("div",ue,[n(e(_),{for:"name"},{default:l(()=>t[16]||(t[16]=[u("Tên sản phẩm")])),_:1,__:[16]}),n(e(v),{id:"name",modelValue:e(s).name,"onUpdate:modelValue":t[1]||(t[1]=o=>e(s).name=o),placeholder:"Nhập tên sản phẩm"},null,8,["modelValue"]),e(s).errors.name?(a(),d("p",ce,m(e(s).errors.name),1)):f("",!0)]),i("div",me,[i("div",null,[n(e(_),{for:"brand_id",class:"mb-2"},{default:l(()=>t[17]||(t[17]=[u("Thương hiệu")])),_:1,__:[17]}),n(e(N),{modelValue:e(s).brand_id,"onUpdate:modelValue":t[2]||(t[2]=o=>e(s).brand_id=o),class:"w-0"},{default:l(()=>[n(e(B),{class:"w-full"},{default:l(()=>[n(e(R),{placeholder:"Chọn thương hiệu"})]),_:1}),n(e(j),null,{default:l(()=>[(a(!0),d(h,null,x(L.value,o=>(a(),P(e(G),{key:o.id,value:o.id},{default:l(()=>[u(m(o.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(s).errors.brand_id?(a(),d("p",_e,m(e(s).errors.brand_id),1)):f("",!0)]),i("div",null,[n(e(_),{for:"category_id",class:"mb-2"},{default:l(()=>t[18]||(t[18]=[u("Danh mục")])),_:1,__:[18]}),n(e(N),{modelValue:e(s).category_id,"onUpdate:modelValue":t[3]||(t[3]=o=>e(s).category_id=o),class:"w-0"},{default:l(()=>[n(e(B),{class:"w-full"},{default:l(()=>[n(e(R),{placeholder:"Chọn danh mục"})]),_:1}),n(e(j),null,{default:l(()=>[(a(!0),d(h,null,x(F.value,o=>(a(),P(e(G),{key:o.id,value:o.id},{default:l(()=>[u(m(o.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(s).errors.category_id?(a(),d("p",fe,m(e(s).errors.category_id),1)):f("",!0)])]),i("div",ge,[n(e(_),null,{default:l(()=>t[19]||(t[19]=[u("Thông số kỹ thuật")])),_:1,__:[19]}),i("div",he,[X(i("textarea",{"onUpdate:modelValue":t[4]||(t[4]=o=>e(s).specs=o),class:"w-full rounded-md border border-gray-300 p-2 font-mono text-sm",rows:"10",placeholder:`{
  "key1": "value1",
  "key2": "value2"
}`},null,512),[[Y,e(s).specs]]),t[20]||(t[20]=i("p",{class:"text-sm text-gray-500"},"Nhập thông số kỹ thuật theo định dạng JSON",-1)),e(s).errors.specs?(a(),d("p",ve,m(e(s).errors.specs),1)):f("",!0)])]),i("div",ye,[n(e(T),{id:"is_feature",modelValue:e(s).is_featured,"onUpdate:modelValue":t[5]||(t[5]=o=>e(s).is_featured=o)},null,8,["modelValue"]),n(e(_),{for:"is_feature"},{default:l(()=>t[21]||(t[21]=[u("Sản phẩm nổi bật")])),_:1,__:[21]})]),i("div",xe,[n(e(T),{id:"is_feature",modelValue:e(s).is_active,"onUpdate:modelValue":t[6]||(t[6]=o=>e(s).is_active=o)},null,8,["modelValue"]),n(e(_),{for:"is_feature"},{default:l(()=>t[22]||(t[22]=[u("Hoạt động")])),_:1,__:[22]})]),i("div",be,[i("div",ke,[n(e(_),{for:"import_price"},{default:l(()=>t[23]||(t[23]=[u("Giá nhập")])),_:1,__:[23]}),n(e(v),{id:"import_price",type:"number",modelValue:e(s).import_price,"onUpdate:modelValue":t[7]||(t[7]=o=>e(s).import_price=o),placeholder:"Nhập giá nhập (nghìn đồng)"},null,8,["modelValue"]),e(s).errors.import_price?(a(),d("p",we,m(e(s).errors.import_price),1)):f("",!0)]),i("div",Ve,[n(e(_),{for:"line_price"},{default:l(()=>t[24]||(t[24]=[u("Giá niêm yết")])),_:1,__:[24]}),n(e(v),{id:"line_price",type:"number",modelValue:e(s).line_price,"onUpdate:modelValue":t[8]||(t[8]=o=>e(s).line_price=o),placeholder:"Nhập giá niêm yết (nghìn đồng)"},null,8,["modelValue"]),e(s).errors.line_price?(a(),d("p",Ce,m(e(s).errors.line_price),1)):f("",!0)]),i("div",Me,[n(e(_),{for:"price"},{default:l(()=>t[25]||(t[25]=[u("Giá bán")])),_:1,__:[25]}),n(e(v),{id:"price",type:"number",modelValue:e(s).price,"onUpdate:modelValue":t[9]||(t[9]=o=>e(s).price=o),placeholder:"Nhập giá bán (nghìn đồng)"},null,8,["modelValue"]),e(s).errors.price?(a(),d("p",Se,m(e(s).errors.price),1)):f("",!0)]),i("div",De,[n(e(_),{for:"stock"},{default:l(()=>t[26]||(t[26]=[u("Số lượng")])),_:1,__:[26]}),n(e(v),{id:"stock",type:"number",modelValue:e(s).stock,"onUpdate:modelValue":t[10]||(t[10]=o=>e(s).stock=o),placeholder:"Nhập số lượng"},null,8,["modelValue"]),e(s).errors.stock?(a(),d("p",$e,m(e(s).errors.stock),1)):f("",!0)])])]),i("div",Ae,[n(e(_),{for:"images"},{default:l(()=>t[27]||(t[27]=[u("Hình ảnh sản phẩm")])),_:1,__:[27]}),i("div",Ue,[i("div",Ie,[i("div",Pe,[c.value.length>0?(a(),d("div",Te,[i("img",{src:(p=c.value.find(o=>o.isMain))==null?void 0:p.url,alt:"Main preview",class:"h-full w-full rounded-lg border object-cover"},null,8,Ne),i("button",{type:"button",class:"absolute top-2 right-2 flex h-6 w-6 items-center justify-center rounded-full bg-red-500 text-white opacity-0 transition-opacity group-hover:opacity-100",onClick:t[11]||(t[11]=o=>A(c.value.findIndex(g=>g.isMain)))}," × ")])):(a(),d("div",w({key:1},e(S)(),{onClick:$,class:"flex h-full w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed bg-gray-50 transition-colors hover:bg-gray-100"}),[i("input",ee(te(e(D)())),null,16),t[28]||(t[28]=i("svg",{class:"mb-2 h-8 w-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e(q)?(a(),d("p",Be,"Thả ảnh vào đây...")):(a(),d("p",Re,"Kéo thả ảnh vào đây hoặc click để chọn"))],16))]),i("div",je,[(a(!0),d(h,null,x(c.value.filter(o=>!o.isMain).slice(0,3),(o,g)=>(a(),d("div",{key:o.id,class:"group relative aspect-square cursor-pointer",onClick:b=>z(c.value.findIndex(k=>k.id===o.id))},[i("img",{src:o.url,alt:"Preview",class:"h-full w-full rounded-lg border object-cover"},null,8,Le),i("button",{type:"button",class:"absolute top-2 right-2 flex h-6 w-6 items-center justify-center rounded-full bg-red-500 text-white opacity-0 transition-opacity group-hover:opacity-100",onClick:I(b=>A(c.value.findIndex(k=>k.id===o.id)),["stop"])}," × ",8,Fe)],8,Ge))),128)),(a(!0),d(h,null,x(3-c.value.filter(o=>!o.isMain).length,o=>(a(),d("div",w({key:o},{ref_for:!0},e(S)(),{onClick:$,class:"flex aspect-square cursor-pointer items-center justify-center rounded-lg border-2 border-dashed bg-gray-50 transition-colors hover:bg-gray-100"}),[i("input",w({ref_for:!0},e(D)()),null,16),t[29]||(t[29]=i("svg",{class:"h-6 w-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1))],16))),128))])]),e(s).errors.images?(a(),d("p",He,m(e(s).errors.images),1)):f("",!0)])]),i("div",qe,[n(e(_),{for:"description"},{default:l(()=>t[30]||(t[30]=[u("Mô tả")])),_:1,__:[30]}),n(e(ie),{content:e(s).description,"onUpdate:content":t[12]||(t[12]=o=>e(s).description=o),options:O,contentType:"html",class:"quill-full-width"},null,8,["content"]),e(s).errors.description?(a(),d("p",ze,m(e(s).errors.description),1)):f("",!0)])]),i("div",Ee,[n(e(V),{variant:"outline",type:"button",onClick:t[13]||(t[13]=o=>e(y).visit(r.route("admin.products.index")))},{default:l(()=>t[31]||(t[31]=[u("Hủy")])),_:1,__:[31]}),n(e(V),{type:"submit",disabled:e(s).processing},{default:l(()=>t[32]||(t[32]=[u("Lưu")])),_:1,__:[32]},8,["disabled"])])],32)])])]}),_:1})],64))}});export{xt as default};
